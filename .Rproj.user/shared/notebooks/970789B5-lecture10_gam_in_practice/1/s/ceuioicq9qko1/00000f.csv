"0","rk<-function(x,z){ # R(x,x*) for cubic spline on [0,1] "
"0","  ((z-0.5)^2-1/12)*((x-0.5)^2-1/12)/4- ((abs(x-z)-0.5)^4-(abs(x-z)-0.5)^2/2+7/240)/24"
"0","}"
"0",""
"0","spl.X <-function(x, xk){      # setup model matrix forcubic penalized regression spline "
"0","  q <- length(xk)+2           # number of parameters "
"0","  n <- length(x)              # number of data "
"0","  X <- matrix(1, n, q)        # initialized model matrix "
"0","  X[, 2] <-x                  # set second column to x"
"0","  X[,3:q]<-outer(x,xk,FUN=rk) # and remaining to R(x,xk) "
"0","  X"
"0","}"
